<div class="h-full flex flex-col bg-gray-50">
  <!-- Header with search and categories -->
  <div class="p-4 bg-white shadow-sm border-b">
    <!-- Search Bar -->
    <div class="relative mb-4">
      <lucide-icon
        [img]="searchIcon"
        class="absolute left-[6px] top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"
      >
      </lucide-icon>
      <input
        type="text"
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()"
        placeholder="Search products or scan barcode..."
        class="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
      />
    </div>

    <!-- Category Filters -->
    <div class="flex gap-2 overflow-x-auto pb-2">
      <button
        (click)="selectedCategory.set('all')"
        [class]="
          'px-4 py-2 rounded-lg font-medium transition-all duration-200 whitespace-nowrap ' +
          (selectedCategory() === 'all'
            ? 'bg-blue-500 text-white shadow-lg'
            : 'bg-gray-100 text-gray-700 hover:bg-gray-200')
        "
      >
        All Products
      </button>
      <button
        *ngFor="let category of inventoryService.allCategories()"
        (click)="selectedCategory.set(category.name)"
        [class]="
          'px-4 py-2 rounded-lg font-medium transition-all duration-200 whitespace-nowrap ' +
          (selectedCategory() === category.name
            ? category.color + ' text-white shadow-lg'
            : 'bg-gray-100 text-gray-700 hover:bg-gray-200')
        "
      >
        {{ category.name }}
      </button>
    </div>
  </div>

  <!-- Products Grid -->
  <div class="flex-1 p-4 overflow-y-auto">
    <div
      class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4"
    >
      <div
        *ngFor="let product of filteredProducts(); trackBy: trackByProductId"
        (click)="addToCart(product)"
        class="bg-white rounded-xl p-4 shadow-sm hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:scale-105 border border-gray-100"
      >
        <!-- Product Image Placeholder -->
        <div
          class="w-full h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg mb-3 flex items-center justify-center"
        >
          <span class="text-2xl">üõçÔ∏è</span>
        </div>

        <!-- Product Info -->
        <div class="space-y-2">
          <h3 class="font-semibold text-gray-800 text-sm line-clamp-2">
            {{ product.name }}
          </h3>
          <p class="text-xs text-gray-500">{{ product.category }}</p>
          <div class="flex items-center justify-between">
            <span class="text-lg font-bold text-green-600"
              >PKR {{ product.sellingPrice | number : "1.2-2" }}</span
            >
          </div>
          <!-- Real-time Stock Status -->
          <app-stock-status
            [productId]="product.id"
            [minStock]="product.minStock"
          ></app-stock-status>
        </div>

        <!-- Add Button -->
        <button
          [disabled]="product.stock === 0"
          [class]="
            'w-full mt-3 py-2 px-3 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 ' +
            (product.stock === 0
              ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
              : 'bg-blue-500 hover:bg-blue-600 text-white')
          "
        >
          <lucide-icon [img]="plusIcon" class="w-4 h-4"></lucide-icon>
          {{ product.stock === 0 ? "Out of Stock" : "Add to Cart" }}
        </button>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="filteredProducts().length === 0" class="text-center py-12">
      <div class="text-6xl mb-4">üîç</div>
      <h3 class="text-xl font-semibold text-gray-600 mb-2">
        No products found
      </h3>
      <p class="text-gray-500">Try adjusting your search or category filter</p>
    </div>
  </div>
</div>
